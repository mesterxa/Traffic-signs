<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<title>Quizzes - DriveLearn</title>
<link rel="stylesheet" href="style.css"><style>
@media (prefers-color-scheme: dark) {
  body { background:#0f172a; color:#e5e7eb; }
  .game, .leaderboard { background:#111827; }
}

.container{
  display:grid;
  grid-template-columns:2fr 1fr;
  gap:25px;
  max-width:1100px;
  margin:60px auto;
}

.game, .leaderboard{
  background:#fff;
  padding:25px;
  border-radius:18px;
  box-shadow:0 15px 35px rgba(0,0,0,.12);
}

.sign{
  font-size:80px;
  margin:20px 0;
}

.options button{
  width:100%;
  padding:14px;
  margin-top:12px;
  border:none;
  border-radius:12px;
  background:#2563eb;
  color:white;
  font-size:16px;
  cursor:pointer;
  transition:.2s;
}
.options button:hover{ transform:scale(1.02); }

.progress{ margin-top:15px; font-weight:600; }

.leaderboard h3{ margin-bottom:10px; }

.leaderboard ul{ list-style:none; padding:0; }
.leaderboard li{ padding:8px 0; border-bottom:1px solid #e5e7eb; }

.ios-toast{
  position:fixed;top:-120px;left:50%;transform:translateX(-50%);
  background:#fff;padding:14px 22px;border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
  transition:.4s;z-index:9999;
}
.ios-toast.show{ top:25px; }
</style><script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
import { getFirestore, doc, setDoc, getDoc, getDocs, collection, query, orderBy } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyAukmQBNFxX_AhpxYOQfDVtGux07OkzN6Q",
  authDomain: "traffic-signs-fc047.firebaseapp.com",
  projectId: "traffic-signs-fc047",
  storageBucket: "traffic-signs-fc047.appspot.com",
  messagingSenderId: "746457575630",
  appId: "1:746457575630:web:3219b85b64e2307126609f"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const questions = [
  { sign:"üõë", correct:"Stop", options:["Stop","No entry","Yield"] },
  { sign:"üö∏", correct:"Pedestrians", options:["School","Pedestrians","Children"] },
  { sign:"‚õî", correct:"No entry", options:["Stop","No entry","Danger"] }
];

let index = 0;
let score = 0;
let currentUser = null;

onAuthStateChanged(auth, async user => {
  if(!user) return location.href="login.html";
  currentUser = user;

  const userDoc = await getDoc(doc(db,"users",user.uid));
  const u = userDoc.data();

  await setDoc(doc(db,"scores",user.uid),{
    uid:user.uid,
    firstName:u.firstName,
    lastName:u.lastName,
    points:0,
    updatedAt:new Date()
  });

  loadQuestion();
  loadLeaderboard();
});

function loadQuestion(){
  const q = questions[index];
  document.getElementById("sign").innerText = q.sign;
  const opts = document.getElementById("options");
  opts.innerHTML="";
  q.options.forEach(o=>{
    const b=document.createElement("button");
    b.innerText=o;
    b.onclick=()=>answer(o);
    opts.appendChild(b);
  });
  document.getElementById("progress").innerText = `Question ${index+1}/${questions.length} | Score: ${score}`;
}

async function answer(choice){
  const q = questions[index];
  if(choice===q.correct){ score+=10; toast("Correct ‚úÖ"); }
  else toast("Wrong ‚ùå");

  await setDoc(doc(db,"scores",currentUser.uid),{
    points:score,
    updatedAt:new Date()
  },{merge:true});

  index++;
  if(index<questions.length) loadQuestion();
  else toast("Quiz Finished üéâ");

  loadLeaderboard();
}

async function loadLeaderboard(){
  const q = query(collection(db,"scores"), orderBy("points","desc"));
  const snap = await getDocs(q);
  const list = document.getElementById("leader");
  list.innerHTML="";
  snap.forEach(d=>{
    const s=d.data();
    list.innerHTML+=`<li>${s.firstName} ${s.lastName} ‚Äî ${s.points}</li>`;
  });
}

function toast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2000);
}
</script></head><body>
<div class="navbar">
  <img src="logo.png" class="logo">
  <a href="index.html">Home</a>
</div><div class="container">
  <div class="game">
    <h2>Traffic Quiz</h2>
    <div id="sign" class="sign">üö¶</div>
    <div id="options" class="options"></div>
    <div id="progress" class="progress"></div>
  </div>  <div class="leaderboard">
    <h3>Leaderboard</h3>
    <ul id="leader"></ul>
  </div>
</div><div id="toast" class="ios-toast"></div>
</body>
</html>