<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DriveLearn â€“ Traffic Quiz</title>

<style>
:root{
  --primary:#2563eb;
  --primary-dark:#1e40af;
  --card:#ffffff;
  --radius:16px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,"Segoe UI",sans-serif;
  background:#f1f5f9;
  color:#111827;
}

a{text-decoration:none;color:inherit}

/* Navbar */
.navbar{
  height:56px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:0 18px;
  background:white;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
}
.navbar a{
  color:var(--primary);
  font-weight:600;
  margin-left:14px;
}

/* Hero */
.hero{
  padding:80px 20px;
  text-align:center;
  color:white;
  background:linear-gradient(135deg,var(--primary),var(--primary-dark));
}

/* Quiz */
.container{
  max-width:600px;
  margin:-60px auto 0;
  padding:0 20px;
}
.card{
  background:var(--card);
  padding:30px;
  border-radius:var(--radius);
  box-shadow:0 20px 40px rgba(0,0,0,.15);
  text-align:center;
}

.sign{
  font-size:90px;
  margin-bottom:20px;
}

.options button{
  width:100%;
  margin:10px 0;
  padding:14px;
  border:none;
  border-radius:12px;
  background:var(--primary);
  color:white;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
}
.options button:hover{
  background:var(--primary-dark);
}

.next{
  margin-top:15px;
  padding:12px 30px;
  border-radius:999px;
  background:#16a34a;
  color:white;
  border:none;
  font-weight:700;
  display:none;
  cursor:pointer;
}

/* Congrats */
#congrats{
  display:none;
}
#congrats h2{
  color:#16a34a;
}
</style>
</head>

<body>

<div class="navbar">
  <a href="index.html">Home</a>
  <a href="signs.html">Signs</a>
</div>

<section class="hero">
  <h1>Traffic Quiz</h1>
  <p>Test your knowledge of traffic signs</p>
</section>

<div class="container">
  <div class="card">

    <div id="quizBox">
      <div class="sign" id="sign"></div>
      <div class="options" id="options"></div>
      <button class="next" id="next">Next</button>
    </div>

    <!-- Congrats message -->
    <div id="congrats">
      <h2>ðŸŽ‰ Congratulations!</h2>
      <p id="finalMessage"></p>
      <p><strong>Your Score:</strong> <span id="finalScore"></span></p>
      <p>Redirecting...</p>
    </div>

  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getAuth } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";
import { getFirestore, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

/* Firebase */
const firebaseConfig={
  apiKey:"AIzaSyAukmQBNFxX_AhpxYOQfDVtGux07OkzN6Q",
  authDomain:"traffic-signs-fc047.firebaseapp.com",
  projectId:"traffic-signs-fc047"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

/* Quiz data */
const quiz=[
  {sign:"ðŸ›‘",options:["Stop","No Entry","Parking"],answer:"Stop"},
  {sign:"â›”",options:["Stop","No Entry","Danger"],answer:"No Entry"},
  {sign:"ðŸš¸",options:["Children","Speed","Parking"],answer:"Children"}
];

let i=0,score=0;

const signEl=document.getElementById("sign");
const optionsEl=document.getElementById("options");
const nextBtn=document.getElementById("next");

const quizBox=document.getElementById("quizBox");
const congrats=document.getElementById("congrats");
const finalScore=document.getElementById("finalScore");
const finalMessage=document.getElementById("finalMessage");

function load(){
  signEl.textContent=quiz[i].sign;
  optionsEl.innerHTML="";
  nextBtn.style.display="none";

  quiz[i].options.forEach(o=>{
    const b=document.createElement("button");
    b.textContent=o;
    b.onclick=()=>check(o);
    optionsEl.appendChild(b);
  });
}

function check(ans){
  if(ans===quiz[i].answer) score+=10;
  nextBtn.style.display="inline-block";
}

nextBtn.onclick=()=>{
  i++;
  if(i<quiz.length) load();
  else finish();
};

function finish(){
  quizBox.style.display="none";
  congrats.style.display="block";

  finalScore.textContent=score;
  const result=score>=20?"Passed ðŸŽ‰":"Failed âŒ";
  finalMessage.textContent="You have " + result;

  auth.onAuthStateChanged(async user=>{
    if(user){
      await updateDoc(doc(db,"users",user.uid),{score,result});
    }
    setTimeout(()=>{
      location.href="result.html";
    },3000);
  });
}

load();
</script>

</body>
</html>