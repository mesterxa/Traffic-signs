<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Register - DriveLearn</title>
<link rel="stylesheet" href="style.css">

<!-- iOS Toast Style -->
<style>
.ios-toast {
  position: fixed;
  top: -120px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(255,255,255,0.96);
  color: #000;
  padding: 14px 22px;
  border-radius: 14px;
  font-size: 15px;
  font-weight: 500;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  transition: all 0.45s cubic-bezier(.25,.8,.25,1);
  z-index: 9999;
}

.ios-toast.show {
  top: 25px;
}

.ios-toast.success {
  border-left: 5px solid #34c759;
}

.ios-toast.error {
  border-left: 5px solid #ff3b30;
}
</style>

<!-- Firebase SDK -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyAukmQBNFxX_AhpxYOQfDVtGux07OkzN6Q",
  authDomain: "traffic-signs-fc047.firebaseapp.com",
  projectId: "traffic-signs-fc047",
  storageBucket: "traffic-signs-fc047.appspot.com",
  messagingSenderId: "746457575630",
  appId: "1:746457575630:web:3219b85b64e2307126609f"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

window.registerUser = function() {
  const email = document.getElementById("reg-email").value;
  const password = document.getElementById("reg-pass").value;

  createUserWithEmailAndPassword(auth, email, password)
    .then(() => {
      showToast(
        arabic ? "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­ ðŸ‘‹" : "Account created successfully ðŸ‘‹",
        "success",
        true
      );
    })
    .catch(error => {
      showToast(error.message, "error");
    });
}

window.logoutUser = function() {
  signOut(auth).then(() => {
    showToast(
      arabic ? "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬" : "Logged out",
      "success",
      true
    );
  });
}

onAuthStateChanged(auth, user => {
  const info = document.getElementById("user-info");
  if (user) {
    info.innerHTML = `${arabic ? 'Ù…Ø±Ø­Ø¨Ù‹Ø§' : 'Hello'}, ${user.email}`;
  } else {
    info.innerHTML = "";
  }
});
</script>
</head>

<body>

<!-- iOS Toast -->
<div id="ios-toast" class="ios-toast"></div>

<div class="navbar">
  <div class="logo">DriveLearn</div>
  <div>
    <a href="index.html">Home</a>
    <a href="login.html">Login</a>
    <span class="lang-switch" onclick="toggleLanguage()">AR</span>
  </div>
</div>

<div class="auth-box">
  <h2 id="auth-title">Register</h2>
  <input type="email" id="reg-email" placeholder="Email">
  <input type="password" id="reg-pass" placeholder="Password">
  <button onclick="registerUser()" id="auth-btn">Register</button>
  <p id="auth-footer">Already have an account? <a href="login.html">Login</a></p>
</div>

<div id="user-info"></div>

<script>
let arabic = false;

function toggleLanguage() {
  arabic = !arabic;
  document.body.classList.toggle("rtl");

  document.getElementById("auth-title").innerText = arabic ? "ØªØ³Ø¬ÙŠÙ„" : "Register";
  document.getElementById("reg-email").placeholder = arabic ? "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" : "Email";
  document.getElementById("reg-pass").placeholder = arabic ? "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" : "Password";
  document.getElementById("auth-btn").innerText = arabic ? "ØªØ³Ø¬ÙŠÙ„" : "Register";
  document.getElementById("auth-footer").innerHTML = arabic
    ? 'Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ <a href="login.html">Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„</a>'
    : 'Already have an account? <a href="login.html">Login</a>';
}

function showToast(message, type = "success", redirect = false) {
  const toast = document.getElementById("ios-toast");
  toast.textContent = message;
  toast.className = `ios-toast show ${type}`;

  setTimeout(() => {
    toast.classList.remove("show");
    if (redirect) {
      window.location.href = "index.html";
    }
  }, 2000);
}
</script>

</body>
</html>