<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DriveLearn â€“ Teacher Panel</title>

<style>
body{margin:0;font-family:"Segoe UI";background:#f8fafc}
.navbar{padding:14px 20px;background:#2563eb;color:white;font-weight:700}
.container{max-width:1100px;margin:40px auto;padding:0 20px}
table{width:100%;border-collapse:collapse;background:white;
box-shadow:0 10px 30px rgba(0,0,0,.1);border-radius:12px;overflow:hidden}
th,td{padding:14px;border-bottom:1px solid #e5e7eb;text-align:center}
th{background:#1e40af;color:white}
input{padding:8px;border-radius:6px;border:1px solid #ccc;width:90%}
.pass{color:green;font-weight:700}
.fail{color:red;font-weight:700}
</style>
</head>

<body>

<div class="navbar">Teacher Dashboard</div>

<div class="container">
<table>
<thead>
<tr>
<th>Name</th>
<th>Email</th>
<th>Score</th>
<th>Note</th>
<th>Status</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getFirestore, collection, getDocs, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyAukmQBNFxX_AhpxYOQfDVtGux07OkzN6Q",
  authDomain:"traffic-signs-fc047.firebaseapp.com",
  projectId:"traffic-signs-fc047"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);
const table=document.getElementById("table");

async function load(){
  const snap=await getDocs(collection(db,"users"));
  table.innerHTML="";
  snap.forEach(d=>{
    const u=d.data();
    table.innerHTML+=`
    <tr>
      <td>${u.firstName} ${u.lastName}</td>
      <td>${u.email}</td>
      <td>${u.score ?? "-"}</td>
      <td>
        <input value="${u.note ?? ""}"
        onchange="save('${d.id}',this.value)">
      </td>
      <td class="${u.result==="Passed"?"pass":"fail"}">
        ${u.result ?? "Pending"}
      </td>
    </tr>`;
  });
}

window.save=async(id,note)=>{
  await updateDoc(doc(db,"users",id),{note});
};

load();
</script>

</body>
</html>